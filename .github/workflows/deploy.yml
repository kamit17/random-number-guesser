  test:
    name: Run Tests
    runs-on: ubuntu-latest
    env:
      ELASTICSEARCH_HOST: "http://localhost:9200"
      ELASTICSEARCH_USER: "elastic"
      ELASTICSEARCH_PASSWORD: "changeme"
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 18

      - name: Install dependencies
        run: npm install

      - name: Start Elasticsearch in Docker
        run: |
          docker run -d --name elasticsearch-test -p 9200:9200 \
            -e "discovery.type=single-node" \
            -e "ELASTIC_USERNAME=elastic" \
            -e "ELASTIC_PASSWORD=changeme" \
            docker.elastic.co/elasticsearch/elasticsearch:8.11.0
          sleep 30  # Wait for Elasticsearch to start

      - name: Run tests with Jest
        run: npm test

